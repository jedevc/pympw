#!/bin/bash

###
# Simple tool to create a pop-up window to generate an MPW password.
#
# To use, simply add a keybinding for mpw-prompt using your window manager's
# preferred method.
#
# Dependencies:
# 	xterm              - pop-up terminal
# 	xsel               - copying to the clipboard
#   xdotool (optional) - window highlighting magic

if type xdotool > /dev/null; then
	WINDOW=`xdotool getactivewindow`
fi

echo -n | xsel -bi

xterm -T 'MasterPassword' -e '
mpw prompt -x
if [ $? -ne 0 ]; then read; fi
'

if type xdotool > /dev/null; then
	xdotool windowactivate $WINDOW key 'ctrl+shift+v'
fi
